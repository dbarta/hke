<div data-controller="visibility">
  <div class="flex gap-4">
    <%= toggle_visibility_button if defined?(toggle_visibility_button) %>
    <div class="grid grid-cols-2 gap-4">
      <!-- Basic Information -->
      <div class="space-y-4">
        <h5 class="text-lg font-medium">פרטים אישיים</h5>

        <div class="field">
          <%= form.label :first_name, t('first_name') + " *", class: "block text-sm font-medium text-gray-700" %>
          <%= form.text_field :first_name, required: true, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" %>
        </div>

        <div class="field">
          <%= form.label :last_name, t('last_name') + " *", class: "block text-sm font-medium text-gray-700" %>
          <%= form.text_field :last_name, required: true, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" %>
        </div>

        <div class="field">
          <%= form.label :email, t('email') + " *", class: "block text-sm font-medium text-gray-700" %>
          <%= form.email_field :email, required: true, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" %>
        </div>

        <div class="field">
          <%= form.label :community_id, t('admin.users.index.community'), class: "block text-sm font-medium text-gray-700" %>
          <%= form.collection_select :community_id, Hke::Community.all, :id, :name,
              { prompt: 'בחר קהילה' },
              { class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" } %>
        </div>

        <% unless @user.persisted? %>
          <div class="field">
            <%= form.label :password, "סיסמה *", class: "block text-sm font-medium text-gray-700" %>
            <%= form.password_field :password, required: true, minlength: 6, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" %>
            <p class="mt-1 text-sm text-gray-500">לפחות 6 תווים</p>
          </div>

          <div class="field">
            <%= form.label :password_confirmation, "אישור סיסמה *", class: "block text-sm font-medium text-gray-700" %>
            <%= form.password_field :password_confirmation, required: true, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" %>
          </div>
        <% end %>
      </div>

      <!-- Roles -->
      <div class="space-y-4">
        <h5 class="text-lg font-medium">תפקידים</h5>
        <div class="space-y-2">
          <div class="flex items-center">
            <%= form.check_box :system_admin, { checked: @user.system_admin? }, "true", "false" %>
            <%= form.label :system_admin, "מנהל מערכת", class: "ml-2" %>
          </div>
          <div class="flex items-center">
            <%= form.check_box :community_admin, { checked: @user.community_admin? }, "true", "false" %>
            <%= form.label :community_admin, "מנהל קהילה", class: "ml-2" %>
          </div>
          <div class="flex items-center">
            <%= form.check_box :community_user, { checked: @user.community_user? }, "true", "false" %>
            <%= form.label :community_user, "משתמש קהילה", class: "ml-2" %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
